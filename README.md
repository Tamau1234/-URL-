# 🔓 Phishing URL Defanger

**フィッシングサイトURL無効化解除・確認ツール**

セキュリティレポートなどで使用される無効化処理されたURL（例: `hxxp://example[.]com`）を、有効なURL（例: `http://example.com`）に変換し、確認を容易にするChrome拡張機能です。

---

## 📋 機能

### ✅ 主な機能

1. **URL無効化解除**
   - `hxxp://` → `http://`
   - `hxxps://` → `https://`
   - `[.]` → `.`
   - `(.)` → `.`
   - `[@]` → `@`
   - その他の一般的な無効化パターンに対応

2. **リアルタイム変換**
   - 入力と同時に自動変換
   - 入力フィールドに貼り付けるだけで即座に結果を表示

3. **クリップボードコピー**
   - ワンクリックで変換後のURLをコピー
   - キーボードショートカット対応（Ctrl+Enter / Cmd+Enter）

4. **URL確認機能**
   - 新しいタブでURLを開いて確認
   - バックグラウンドタブで開くため、作業を中断しません

5. **視覚的フィードバック**
   - 有効なURL: 緑色の枠線
   - 無効なURL: 赤色の枠線
   - 操作完了時の通知メッセージ

---

## 🚀 インストール方法

### 方法1: Chrome拡張機能として読み込む（開発者モード）

1. **アイコンの生成**（初回のみ）
   ```
   icons/generate-icons.html をブラウザで開く
   → 「すべてのアイコンをダウンロード」をクリック
   → ダウンロードしたPNGファイルを icons/ フォルダに保存
   ```

2. **Chromeで拡張機能を読み込む**
   - Chrome を開き、アドレスバーに `chrome://extensions/` と入力
   - 右上の「デベロッパーモード」を有効化
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - このプロジェクトのフォルダを選択

3. **使用開始**
   - ツールバーに拡張機能のアイコンが表示されます
   - アイコンをクリックしてポップアップを開きます

### 方法2: Chrome Web Storeから（将来的に公開予定）

現在は開発版のため、方法1をご利用ください。

---

## 💡 使用方法

### 基本的な使い方

1. **拡張機能アイコンをクリック**してポップアップを開く

2. **無効化されたURLを入力フィールドに貼り付け**
   ```
   例: hxxps://malware[.]site/login.php
   ```

3. **自動的に変換結果が表示されます**
   ```
   結果: https://malware.site/login.php
   ```

4. **アクションを選択**
   - **📋 コピー**: 変換後のURLをクリップボードにコピー
   - **🔍 確認**: 新しいタブでURLを開いて確認

### キーボードショートカット

- **Ctrl+Enter** (Windows/Linux) または **Cmd+Enter** (Mac): URLをコピー
- **Ctrl+Shift+Enter** または **Cmd+Shift+Enter**: URLを開く

---

## 🔧 技術仕様

### 使用技術

- **Manifest V3**: Chrome拡張機能の最新規格
- **Pure JavaScript (ES6+)**: フレームワーク不要の軽量設計
- **HTML5 / CSS3**: モダンなUI/UX

### パーミッション

本拡張機能が要求する最小限のパーミッション:

- `clipboardWrite`: クリップボードへのURLコピー機能
- `tabs`: 新しいタブでURLを開く機能

**セキュリティ上の注意**: 本拡張機能は以下を行いません:
- データ収集
- 外部サーバーへの通信
- コンテンツスクリプトの注入
- ブラウジング履歴へのアクセス

### ファイル構成

```
Fishi-site-chrome/
├── manifest.json       # 拡張機能の設定ファイル
├── popup.html          # ポップアップUI
├── popup.js            # イベント処理とブラウザAPI連携
├── popup.css           # スタイリング
├── utils.js            # URL変換ロジック
├── icons/              # 拡張機能アイコン
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   ├── icon128.png
│   └── generate-icons.html  # アイコン生成ツール
└── README.md           # このファイル
```

---

## 📝 サポートされる変換パターン

| 無効化パターン | 変換後 | 例 |
|--------------|--------|-----|
| `hxxp://` | `http://` | `hxxp://example.com` → `http://example.com` |
| `hxxps://` | `https://` | `hxxps://example.com` → `https://example.com` |
| `[.]` | `.` | `example[.]com` → `example.com` |
| `(.)` | `.` | `example(.)com` → `example.com` |
| `[@]` | `@` | `user[@]example.com` → `user@example.com` |
| `[://]` | `://` | `http[://]example.com` → `http://example.com` |
| プロトコルなし | `http://`を追加 | `example[.]com` → `http://example.com` |

### 変換例

```
入力: hxxps://malware[.]site[.]org/login.php?user=admin[@]example[.]com
出力: https://malware.site.org/login.php?user=admin@example.com

入力: HxXpS://PhIsHiNg[.]ExAmPlE[.]CoM
出力: https://phishing.example.com

入力: hxxp://192[.]168[.]1[.]1:8080/admin
出力: http://192.168.1.1:8080/admin

入力: example[.]com
出力: http://example.com
```

---

## 🧪 テスト方法

### 機能テスト

以下のURLで動作確認ができます:

1. **基本的な変換**
   ```
   hxxp://example[.]com
   → http://example.com
   ```

2. **HTTPS + 複数ドット**
   ```
   hxxps://test[.]example[.]com
   → https://test.example.com
   ```

3. **IPアドレス**
   ```
   hxxp://192[.]168[.]1[.]1
   → http://192.168.1.1
   ```

4. **パスとクエリ**
   ```
   hxxps://example[.]com/path?query=value
   → https://example.com/path?query=value
   ```

5. **大文字小文字混在**
   ```
   HxXpS://ExAmPlE[.]CoM
   → https://example.com
   ```

### 期待される動作

- ✅ リアルタイムで変換結果が表示される
- ✅ 有効なURLの場合、緑色の枠線が表示される
- ✅ 無効なURLの場合、赤色の枠線が表示され、ボタンが無効化される
- ✅ コピーボタンで正しくクリップボードにコピーされる
- ✅ 確認ボタンで新しいタブでURLが開かれる

---

## 🛡️ セキュリティに関する注意事項

### ⚠️ 重要な警告

本ツールは、**セキュリティ分析者やSOC担当者**が、フィッシングサイトやマルウェア配布サイトを調査するためのツールです。

**使用上の注意**:

1. **フィッシングサイトは危険です**
   - 本ツールで変換したURLを開く際は、必ず安全な環境（仮想マシン、サンドボックス等）で行ってください
   - Chrome の Safe Browsing 機能は有効のまま動作しますが、100%の保護を保証するものではありません

2. **個人情報を入力しないでください**
   - フィッシングサイトに個人情報、パスワード、クレジットカード情報等を入力しないでください

3. **業務目的での使用を推奨**
   - 本ツールは主にセキュリティ専門家、インシデントレスポンス担当者向けです
   - 一般ユーザーの方は、不審なURLを開かないことを推奨します

4. **法令遵守**
   - 本ツールの使用にあたっては、適用される法令を遵守してください
   - 不正アクセス禁止法等に抵触する行為は絶対に行わないでください

### プライバシーとデータ収集

- **データ収集なし**: 本拡張機能は一切のデータを収集しません
- **オフライン動作**: 外部サーバーとの通信は一切行いません
- **ローカル処理**: すべての変換処理はブラウザ内で完結します

---

## 🐛 トラブルシューティング

### 拡張機能が読み込めない

**症状**: 「パッケージ化されていない拡張機能を読み込む」で失敗する

**解決方法**:
1. `manifest.json` が存在することを確認
2. すべてのファイル（HTML, CSS, JS）が存在することを確認
3. アイコンファイルが不足している場合は警告が出ますが、機能には影響しません

### コピー機能が動作しない

**症状**: コピーボタンをクリックしても何も起こらない

**解決方法**:
1. クリップボードへのアクセス許可を確認
2. ブラウザのコンソールでエラーを確認（F12 → Console）
3. 別のブラウザやシークレットモードで試す

### URLが開かない

**症状**: 確認ボタンをクリックしても新しいタブが開かない

**解決方法**:
1. `tabs` パーミッションが `manifest.json` に含まれているか確認
2. ポップアップブロッカーを無効化
3. 変換後のURLが有効かどうか確認（緑色の枠線が表示されているか）

---

## 🔄 今後の予定（Future Enhancements）

以下の機能は将来的に追加予定です:

- [ ] 設定ページ（デフォルトプロトコル選択、タブの動作設定）
- [ ] コンテキストメニュー統合（右クリックで変換）
- [ ] 一括変換機能（複数URLの同時処理）
- [ ] 変換履歴の保存
- [ ] 追加の無効化パターン対応
- [ ] エクスポート機能（Markdown, JSON形式）
- [ ] ダークモード対応

---

## 🤝 貢献

バグ報告や機能要望は、Issue を作成してください。

プルリクエストも歓迎します！

---

## 📄 ライセンス

MIT License

Copyright (c) 2025

本ソフトウェアは無保証で提供されます。使用に伴うリスクはすべてユーザーが負うものとします。

---

## 👨‍💻 開発者向け情報

### 開発環境のセットアップ

```bash
# リポジトリをクローン
git clone <repository-url>
cd Fishi-site-chrome

# アイコンを生成（ブラウザでHTMLファイルを開く）
# icons/generate-icons.html

# Chrome拡張機能として読み込む
# chrome://extensions/ → デベロッパーモード → パッケージ化されていない拡張機能を読み込む
```

### コードの構造

- **utils.js**: 純粋関数（変換ロジック、検証ロジック）
- **popup.js**: DOM操作、イベントハンドリング、ブラウザAPI呼び出し
- **popup.html**: UI構造
- **popup.css**: スタイリング、視覚的フィードバック

### デバッグ方法

1. 拡張機能アイコンを右クリック → 「ポップアップを検証」
2. Developer Tools が開きます
3. Console タブでエラーやログを確認

### コーディング規約

- ES6+ モジュール構文を使用
- セミコロンあり
- インデント: 2スペース
- コメント: 日本語でOK

---

## 📞 サポート

質問や問題がある場合は、Issue を作成してください。

---

**免責事項**: 本ツールは教育・研究目的で提供されています。悪意のあるサイトへのアクセスは自己責任で行ってください。開発者は本ツールの使用によって生じたいかなる損害についても責任を負いません。
